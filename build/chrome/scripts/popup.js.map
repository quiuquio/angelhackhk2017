{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/scripts/popup.js","src/scripts/utils/ext.js","src/scripts/utils/storage.js"],"names":[],"mappings":"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","file":"popup.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import ext from \"./utils/ext\";\nimport storage from \"./utils/storage\";\n\nvar popup = document.getElementById(\"app\");\nstorage.get('color', function(resp) {\n  var color = resp.color;\n  if(color) {\n    popup.style.backgroundColor = color\n  }\n});\n\nvar template = (data) => {\n  var json = JSON.stringify(data);\n  return (`\n  <div class=\"site-description\">\n    <h3 class=\"title\">${data.title}</h3>\n    <p class=\"description\">${data.description}</p>\n    <a href=\"${data.url}\" target=\"_blank\" class=\"url\">${data.url}</a>\n    <div>${data.imagesArray}</div>\n  </div>\n  <div class=\"action-container\">\n    <button data-bookmark='${json}' id=\"save-btn\" class=\"btn btn-primary\">Save</button>\n  </div>\n  `);\n}\nvar renderMessage = (message) => {\n  var displayContainer = document.getElementById(\"display-container\");\n  displayContainer.innerHTML = `<p class='message'>${message}</p>`;\n}\n\nvar renderBookmark = (data) => {\n  var displayContainer = document.getElementById(\"display-container\")\n  if(data) {\n    var tmpl = template(data);\n    displayContainer.innerHTML = tmpl;  \n  } else {\n    renderMessage(\"Sorry, could not extract this page's title and URL\")\n  }\n}\n\next.tabs.query({active: true, currentWindow: true}, function(tabs) {\n  var activeTab = tabs[0];\n  chrome.tabs.sendMessage(activeTab.id, { action: 'process-page' }, renderBookmark);\n});\n\npopup.addEventListener(\"click\", function(e) {\n  if(e.target && e.target.matches(\"#save-btn\")) {\n    e.preventDefault();\n    var data = e.target.getAttribute(\"data-bookmark\");\n    ext.runtime.sendMessage({ action: \"perform-save\", data: data }, function(response) {\n      if(response && response.action === \"saved\") {\n        renderMessage(\"Your bookmark was saved successfully!\");\n      } else {\n        renderMessage(\"Sorry, there was an error while saving your bookmark.\");\n      }\n    })\n  }\n});\n\nvar optionsLink = document.querySelector(\".js-options\");\noptionsLink.addEventListener(\"click\", function(e) {\n  e.preventDefault();\n  ext.tabs.create({'url': ext.extension.getURL('options.html')});\n})\n","const apis = [\n  'alarms',\n  'bookmarks',\n  'browserAction',\n  'commands',\n  'contextMenus',\n  'cookies',\n  'downloads',\n  'events',\n  'extension',\n  'extensionTypes',\n  'history',\n  'i18n',\n  'idle',\n  'notifications',\n  'pageAction',\n  'runtime',\n  'storage',\n  'tabs',\n  'webNavigation',\n  'webRequest',\n  'windows',\n]\n\nfunction Extension () {\n  const _this = this\n\n  apis.forEach(function (api) {\n\n    _this[api] = null\n\n    try {\n      if (chrome[api]) {\n        _this[api] = chrome[api]\n      }\n    } catch (e) {}\n\n    try {\n      if (window[api]) {\n        _this[api] = window[api]\n      }\n    } catch (e) {}\n\n    try {\n      if (browser[api]) {\n        _this[api] = browser[api]\n      }\n    } catch (e) {}\n    try {\n      _this.api = browser.extension[api]\n    } catch (e) {}\n  })\n\n  try {\n    if (browser && browser.runtime) {\n      this.runtime = browser.runtime\n    }\n  } catch (e) {}\n\n  try {\n    if (browser && browser.browserAction) {\n      this.browserAction = browser.browserAction\n    }\n  } catch (e) {}\n\n}\n\nmodule.exports = new Extension();","import ext from \"./ext\";\n\nmodule.exports = (ext.storage.sync ? ext.storage.sync : ext.storage.local);"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc2NyaXB0cy9wb3B1cC5qcyIsInNyYy9zY3JpcHRzL3V0aWxzL2V4dC5qcyIsInNyYy9zY3JpcHRzL3V0aWxzL3N0b3JhZ2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBOzs7O0FBQ0E7Ozs7OztBQUVBLElBQUksUUFBUSxTQUFTLGNBQVQsQ0FBd0IsS0FBeEIsQ0FBWjtBQUNBLGtCQUFRLEdBQVIsQ0FBWSxPQUFaLEVBQXFCLFVBQVMsSUFBVCxFQUFlO0FBQ2xDLE1BQUksUUFBUSxLQUFLLEtBQWpCO0FBQ0EsTUFBRyxLQUFILEVBQVU7QUFDUixVQUFNLEtBQU4sQ0FBWSxlQUFaLEdBQThCLEtBQTlCO0FBQ0Q7QUFDRixDQUxEOztBQU9BLElBQUksV0FBVyxTQUFYLFFBQVcsQ0FBQyxJQUFELEVBQVU7QUFDdkIsTUFBSSxPQUFPLEtBQUssU0FBTCxDQUFlLElBQWYsQ0FBWDtBQUNBLDRFQUVzQixLQUFLLEtBRjNCLDRDQUcyQixLQUFLLFdBSGhDLDRCQUlhLEtBQUssR0FKbEIsMkNBSXNELEtBQUssR0FKM0QsdUJBS1MsS0FBSyxXQUxkLHlGQVEyQixJQVIzQjtBQVdELENBYkQ7QUFjQSxJQUFJLGdCQUFnQixTQUFoQixhQUFnQixDQUFDLE9BQUQsRUFBYTtBQUMvQixNQUFJLG1CQUFtQixTQUFTLGNBQVQsQ0FBd0IsbUJBQXhCLENBQXZCO0FBQ0EsbUJBQWlCLFNBQWpCLDJCQUFtRCxPQUFuRDtBQUNELENBSEQ7O0FBS0EsSUFBSSxpQkFBaUIsU0FBakIsY0FBaUIsQ0FBQyxJQUFELEVBQVU7QUFDN0IsTUFBSSxtQkFBbUIsU0FBUyxjQUFULENBQXdCLG1CQUF4QixDQUF2QjtBQUNBLE1BQUcsSUFBSCxFQUFTO0FBQ1AsUUFBSSxPQUFPLFNBQVMsSUFBVCxDQUFYO0FBQ0EscUJBQWlCLFNBQWpCLEdBQTZCLElBQTdCO0FBQ0QsR0FIRCxNQUdPO0FB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UUFBUSxhQUF2QixFQUFzQztBQUNwQyxXQUFLLGFBQUwsR0FBcUIsUUFBUSxhQUE3QjtBQUNEO0FBQ0YsR0FKRCxDQUlFLE9BQU8sQ0FBUCxFQUFVLENBQUU7QUFFZjs7QUFFRCxPQUFPLE9BQVAsR0FBaUIsSUFBSSxTQUFKLEVBQWpCOzs7OztBQ25FQTs7Ozs7O0FBRUEsT0FBTyxPQUFQLEdBQWtCLGNBQUksT0FBSixDQUFZLElBQVosR0FBbUIsY0FBSSxPQUFKLENBQVksSUFBL0IsR0FBc0MsY0FBSSxPQUFKLENBQVksS0FBcEUiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiaW1wb3J0IGV4dCBmcm9tIFwiLi91dGlscy9leHRcIjtcbmltcG9ydCBzdG9yYWdlIGZyb20gXCIuL3V0aWxzL3N0b3JhZ2VcIjtcblxudmFyIHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhcHBcIik7XG5zdG9yYWdlLmdldCgnY29sb3InLCBmdW5jdGlvbihyZXNwKSB7XG4gIHZhciBjb2xvciA9IHJlc3AuY29sb3I7XG4gIGlmKGNvbG9yKSB7XG4gICAgcG9wdXAuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3JcbiAgfVxufSk7XG5cbnZhciB0ZW1wbGF0ZSA9IChkYXRhKSA9PiB7XG4gIHZhciBqc29uID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gIHJldHVybiAoYFxuICA8ZGl2IGNsYXNzPVwic2l0ZS1kZXNjcmlwdGlvblwiPlxuICAgIDxoMyBjbGFzcz1cInRpdGxlXCI+JHtkYXRhLnRpdGxlfTwvaDM+XG4gICAgPHAgY2xhc3M9XCJkZXNjcmlwdGlvblwiPiR7ZGF0YS5kZXNjcmlwdGlvbn08L3A+XG4gICAgPGEgaHJlZj1cIiR7ZGF0YS51cmx9XCIgdGFyZ2V0PVwiX2JsYW5rXCIgY2xhc3M9XCJ1cmxcIj4ke2RhdGEudXJsfTwvYT5cbiAgICA8ZGl2PiR7ZGF0YS5pbWFnZXNBcnJheX08L2Rpdj5cbiAgPC9kaXY+XG4gIDxkaXYgY2xhc3M9XCJhY3Rpb24tY29udGFpbmVyXCI+XG4gICAgPGJ1dHRvbiBkYXRhLWJvb2ttYXJrPScke2pzb259JyBpZD1cInNhdmUtYnRuXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIj5TYXZlPC9idXR0b24+XG4gIDwvZGl2PlxuICBgKTtcbn1cbnZhciByZW5kZXJNZXNzYWdlID0gKG1lc3NhZ2UpID0+IHtcbiAgdmFyIGRpc3BsYXlDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3BsYXktY29udGFpbmVyXCIpO1xuICBkaXNwbGF5Q29udGFpbmVyLmlubmVySFRNTCA9IGA8cCBjbGFzcz0nbWVzc2FnZSc+JHttZXNzYWdlfTwvcD5gO1xufVxuXG52YXIgcmVuZGVyQm9va21hcmsgPSAoZGF0YSkgPT4ge1xuICB2YXIgZGlzcGxheUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGlzcGxheS1jb250YWluZXJcIilcbiAgaWYoZGF0YSkge1xuICAgIHZhciB0bXBsID0gdGVtcGxhdGUoZGF0YSk7XG4gICAgZGlzcGxheUNvbnRhaW5lci5pbm5lckhUTUwgPSB0bXBsOyAgXG4gIH0gZWxzZSB7XG4gICAgcmVuZGVyTWVzc2FnZShcIlNvcnJ5LCBjb3VsZCBub3QgZXh0cmFjdCB0aGlzIHBhZ2UncyB0aXRsZSBhbmQgVVJMXCIpXG4gIH1cbn1cblxuZXh0LnRhYnMucXVlcnkoe2FjdGl2ZTogdHJ1ZSwgY3VycmVudFdpbmRvdzogdHJ1ZX0sIGZ1bmN0aW9uKHRhYnMpIHtcbiAgdmFyIGFjdGl2ZVRhYiA9IHRhYnNbMF07XG4gIGNocm9tZS50YWJzLnNlbmRNZXNzYWdlKGFjdGl2ZVRhYi5pZCwgeyBhY3Rpb246ICdwcm9jZXNzLXBhZ2UnIH0sIHJlbmRlckJvb2ttYXJrKTtcbn0pO1xuXG5wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuICBpZihlLnRhcmdldCAmJiBlLnRhcmdldC5tYXRjaGVzKFwiI3NhdmUtYnRuXCIpKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHZhciBkYXRhID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1ib29rbWFya1wiKTtcbiAgICBleHQucnVudGltZS5zZW5kTWVzc2FnZSh7IGFjdGlvbjogXCJwZXJmb3JtLXNhdmVcIiwgZGF0YTogZGF0YSB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgaWYocmVzcG9uc2UgJiYgcmVzcG9uc2UuYWN0aW9uID09PSBcInNhdmVkXCIpIHtcbiAgICAgICAgcmVuZGVyTWVzc2FnZShcIllvdXIgYm9va21hcmsgd2FzIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZW5kZXJNZXNzYWdlKFwiU29ycnksIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBzYXZpbmcgeW91ciBib29rbWFyay5cIik7XG4gICAgICB9XG4gICAgfSlcbiAgfVxufSk7XG5cbnZhciBvcHRpb25zTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuanMtb3B0aW9uc1wiKTtcbm9wdGlvbnNMaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgZXh0LnRhYnMuY3JlYXRlKHsndXJsJzogZXh0LmV4dGVuc2lvbi5nZXRVUkwoJ29wdGlvbnMuaHRtbCcpfSk7XG59KVxuIiwiY29uc3QgYXBpcyA9IFtcbiAgJ2FsYXJtcycsXG4gICdib29rbWFya3MnLFxuICAnYnJvd3NlckFjdGlvbicsXG4gICdjb21tYW5kcycsXG4gICdjb250ZXh0TWVudXMnLFxuICAnY29va2llcycsXG4gICdkb3dubG9hZHMnLFxuICAnZXZlbnRzJyxcbiAgJ2V4dGVuc2lvbicsXG4gICdleHRlbnNpb25UeXBlcycsXG4gICdoaXN0b3J5JyxcbiAgJ2kxOG4nLFxuICAnaWRsZScsXG4gICdub3RpZmljYXRpb25zJyxcbiAgJ3BhZ2VBY3Rpb24nLFxuICAncnVudGltZScsXG4gICdzdG9yYWdlJyxcbiAgJ3RhYnMnLFxuICAnd2ViTmF2aWdhdGlvbicsXG4gICd3ZWJSZXF1ZXN0JyxcbiAgJ3dpbmRvd3MnLFxuXVxuXG5mdW5jdGlvbiBFeHRlbnNpb24gKCkge1xuICBjb25zdCBfdGhpcyA9IHRoaXNcblxuICBhcGlzLmZvckVhY2goZnVuY3Rpb24gKGFwaSkge1xuXG4gICAgX3RoaXNbYXBpXSA9IG51bGxcblxuICAgIHRyeSB7XG4gICAgICBpZiAoY2hyb21lW2FwaV0pIHtcbiAgICAgICAgX3RoaXNbYXBpXSA9IGNocm9tZVthcGldXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge31cblxuICAgIHRyeSB7XG4gICAgICBpZiAod2luZG93W2FwaV0pIHtcbiAgICAgICAgX3RoaXNbYXBpXSA9IHdpbmRvd1thcGldXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge31cblxuICAgIHRyeSB7XG4gICAgICBpZiAoYnJvd3NlclthcGldKSB7XG4gICAgICAgIF90aGlzW2FwaV0gPSBicm93c2VyW2FwaV1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7fVxuICAgIHRyeSB7XG4gICAgICBfdGhpcy5hcGkgPSBicm93c2VyLmV4dGVuc2lvblthcGldXG4gICAgfSBjYXRjaCAoZSkge31cbiAgfSlcblxuICB0cnkge1xuICAgIGlmIChicm93c2VyICYmIGJyb3dzZXIucnVudGltZSkge1xuICAgICAgdGhpcy5ydW50aW1lID0gYnJvd3Nlci5ydW50aW1lXG4gICAgfVxuICB9IGNhdGNoIChlKSB7fVxuXG4gIHRyeSB7XG4gICAgaWYgKGJyb3dzZXIgJiYgYnJvd3Nlci5icm93c2VyQWN0aW9uKSB7XG4gICAgICB0aGlzLmJyb3dzZXJBY3Rpb24gPSBicm93c2VyLmJyb3dzZXJBY3Rpb25cbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHt9XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgRXh0ZW5zaW9uKCk7IiwiaW1wb3J0IGV4dCBmcm9tIFwiLi9leHRcIjtcblxubW9kdWxlLmV4cG9ydHMgPSAoZXh0LnN0b3JhZ2Uuc3luYyA/IGV4dC5zdG9yYWdlLnN5bmMgOiBleHQuc3RvcmFnZS5sb2NhbCk7Il19"}